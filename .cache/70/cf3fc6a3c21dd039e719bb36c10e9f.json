{"id":"El7n","dependencies":[{"name":"C:\\Users\\wrigh\\Desktop\\Projects\\ukvisasponsorship\\package.json","includedInParent":true,"mtime":1764337835993},{"name":"axios","loc":{"line":1,"column":18,"index":18},"parent":"C:\\Users\\wrigh\\Desktop\\Projects\\ukvisasponsorship\\public\\js\\jobs.js","resolved":"C:\\Users\\wrigh\\Desktop\\Projects\\ukvisasponsorship\\node_modules\\axios\\index.js"},{"name":"./alerts","loc":{"line":2,"column":26,"index":54},"parent":"C:\\Users\\wrigh\\Desktop\\Projects\\ukvisasponsorship\\public\\js\\jobs.js","resolved":"C:\\Users\\wrigh\\Desktop\\Projects\\ukvisasponsorship\\public\\js\\alerts.js"}],"generated":{"js":"\"use strict\";var e=n(require(\"axios\")),t=require(\"./alerts\");function n(e){return e&&e.__esModule?e:{default:e}}function a(){var e,t,n=\"function\"==typeof Symbol?Symbol:{},r=n.iterator||\"@@iterator\",s=n.toStringTag||\"@@toStringTag\";function c(n,a,r,s){var c=a&&a.prototype instanceof l?a:l,d=Object.create(c.prototype);return o(d,\"_invoke\",function(n,a,o){var r,s,c,l=0,d=o||[],p=!1,u={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(t,n){return r=t,s=0,c=e,u.n=n,i}};function v(n,a){for(s=n,c=a,t=0;!p&&l&&!o&&t<d.length;t++){var o,r=d[t],v=u.p,f=r[2];n>3?(o=f===a)&&(c=r[(s=r[4])?5:(s=3,3)],r[4]=r[5]=e):r[0]<=v&&((o=n<2&&v<r[1])?(s=0,u.v=a,u.n=r[1]):v<f&&(o=n<3||r[0]>a||a>f)&&(r[4]=n,r[5]=a,u.n=f,s=0))}if(o||n>1)return i;throw p=!0,a}return function(o,d,f){if(l>1)throw TypeError(\"Generator is already running\");for(p&&1===d&&v(d,f),s=d,c=f;(t=s<2?e:c)||!p;){r||(s?s<3?(s>1&&(u.n=-1),v(s,c)):u.n=c:u.v=c);try{if(l=2,r){if(s||(o=\"next\"),t=r[o]){if(!(t=t.call(r,c)))throw TypeError(\"iterator result is not an object\");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=r.return)&&t.call(r),s<2&&(c=TypeError(\"The iterator does not provide a '\"+o+\"' method\"),s=1);r=e}else if((t=(p=u.n<0)?c:n.call(a,u))!==i)break}catch(t){r=e,s=1,c=t}finally{l=1}}return{value:t,done:p}}}(n,r,s),!0),d}var i={};function l(){}function d(){}function p(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(o(t={},r,function(){return this}),t),v=p.prototype=l.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,o(e,s,\"GeneratorFunction\")),e.prototype=Object.create(v),e}return d.prototype=p,o(v,\"constructor\",p),o(p,\"constructor\",d),d.displayName=\"GeneratorFunction\",o(p,s,\"GeneratorFunction\"),o(v),o(v,s,\"Generator\"),o(v,r,function(){return this}),o(v,\"toString\",function(){return\"[object Generator]\"}),(a=function(){return{w:c,m:f}})()}function o(e,t,n,a){var r=Object.defineProperty;try{r({},\"\",{})}catch(e){r=0}(o=function(e,t,n,a){function s(t,n){o(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(s(\"next\",0),s(\"throw\",1),s(\"return\",2))})(e,t,n,a)}function r(e,t,n,a,o,r,s){try{var c=e[r](s),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(a,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(a,o){var s=e.apply(t,n);function c(e){r(s,a,o,c,i,\"next\",e)}function i(e){r(s,a,o,c,i,\"throw\",e)}c(void 0)})}}var c=document.querySelector(\".results\"),i=document.getElementById(\"reportJobModal\"),l=document.getElementById(\"closeReportJobModal\"),d=document.getElementById(\"cancelReportJobBtn\"),p=document.getElementById(\"confirmReportJobBtn\"),u=null,v=null,f=function(){i&&(i.classList.add(\"hidden\"),u=null,v=null)},b=function(e,t){i&&(u=e,v=t,i.classList.remove(\"hidden\"))};i&&(l.addEventListener(\"click\",f),d.addEventListener(\"click\",f),i.addEventListener(\"click\",function(e){e.target===i&&f()}),p.addEventListener(\"click\",s(a().m(function n(){return a().w(function(n){for(;;)switch(n.p=n.n){case 0:if(u){n.n=1;break}return n.a(2);case 1:return p.textContent=\"Reporting...\",n.p=2,n.n=3,e.default.patch(\"/api/v1/jobs/\".concat(u,\"/report\"));case 3:(0,t.showAlert)(\"success\",\"Job reported. Thank you.\"),v&&(v.style.display=\"none\"),f(),n.n=5;break;case 4:n.p=4,n.v,(0,t.showAlert)(\"error\",\"Error reporting job.\");case 5:return n.p=5,p.textContent=\"Report Job\",n.f(5);case 6:return n.a(2)}},n,null,[[2,4,5,6]])})))),exports.loadJobData=function(){var n=s(a().m(function n(o){var r,c,i,l,d,p,u,v,f,y,m,h,g,k,w,j,x,C,E,L,A,B,_;return a().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,(r=document.querySelector(\".details\")).innerHTML='<div class=\"spinner\">Loading...</div>',n.n=1,e.default.get(\"/api/v1/jobs/\".concat(o));case 1:return c=n.v,i=!1,l=null,d=!1,p=\"candidate\",n.p=2,n.n=3,e.default.get(\"/api/v1/jobs/saved\");case 3:return\"success\"===(u=n.v).data.status&&(v=u.data.data.jobs)&&Array.isArray(v)&&(i=v.some(function(e){return e._id===o})),n.p=4,n.n=5,e.default.get(\"/api/v1/users/me\");case 5:\"success\"===(f=n.v).data.status&&(l=f.data.data.cv,p=f.data.data.role,(y=f.data.data.appliedJobs)&&Array.isArray(y)&&(d=y.includes(o))),n.n=7;break;case 6:n.p=6,n.v;case 7:n.n=9;break;case 8:n.p=8,n.v;case 9:\"success\"===c.data.status&&(m=c.data.data.job,h=i?\"Saved\":\"Save Job\",g=i?\"btn--save btn--saved\":\"btn--save\",k=d?'<button class=\"btn--standard btn--apply\" disabled style=\"background-color: #1a73c2; cursor: default;\">Applied</button>':m.applicationLink?'<a href=\"'.concat(m.applicationLink,'\" class=\"btn--standard btn--apply\" target=\"_blank\">Apply Now</a>'):l?'\\n              <div class=\"apply-actions\">\\n                  <button class=\"btn--standard btn--apply\" id=\"applyProfileCvBtn\">Apply with Profile CV</button>\\n                  <button class=\"btn--text\" id=\"applyUploadCvBtn\" style=\"margin-top: 10px; display: block; font-size: 0.9em; background: none; border: none; color: var(--brand-primary); cursor: pointer; text-decoration: underline;\">Upload different CV</button>\\n                  <input type=\"file\" id=\"cvUpload\" style=\"display: none;\" accept=\".pdf,.doc,.docx\" />\\n              </div>\\n            ':'\\n              <div class=\"apply-actions\">\\n                  <button class=\"btn--standard btn--apply\" id=\"applyUploadCvBtn\">Apply Now</button>\\n                  <input type=\"file\" id=\"cvUpload\" style=\"display: none;\" accept=\".pdf,.doc,.docx\" />\\n                  <div class=\"save-cv-option\" style=\"margin-top: 10px;\">\\n                      <input type=\"checkbox\" id=\"saveCvCheck\">\\n                      <label for=\"saveCvCheck\" style=\"font-size: 1.2rem;\">Save CV to profile</label>\\n                  </div>\\n              </div>\\n            ',w=[\"admin\",\"employer\"].includes(p),j='\\n        <button class=\"btn-close btn-close-details\" id=\"closeDetailsBtn\">&times;</button>\\n        <div class=\"job-details-content\">\\n          <div class=\"job-header\">\\n            <h2>'.concat(m.title,'</h2>\\n            <p class=\"company-name\">').concat(m.postedBy?m.postedBy.name:\"Company\",'</p>\\n            <div class=\"job-meta\">\\n               <div class=\"meta-item\">\\n                 <span class=\"meta-label\">Location:</span>\\n                 <span class=\"meta-value\">').concat(m.location.city,\", \").concat(m.location.postcode,'</span>\\n               </div>\\n               <div class=\"meta-item\">\\n                 <span class=\"meta-label\">Salary:</span>\\n                 <span class=\"meta-value\">').concat(m.salaryRange?(m.salaryRange.min===m.salaryRange.max?\"£\".concat(m.salaryRange.min.toLocaleString()):\"£\".concat(m.salaryRange.min.toLocaleString()).concat(m.salaryRange.max?\" - £\".concat(m.salaryRange.max.toLocaleString()):\"+\"))+\" per \".concat(m.salaryRange.period||\"year\"):\"Negotiable\",'</span>\\n               </div>\\n               <div class=\"meta-divider\"></div>\\n               <div class=\"meta-item\">\\n                 <span class=\"meta-label\">Type:</span>\\n                 <span class=\"meta-value\">').concat(m.jobType||\"Full-time\",'</span>\\n               </div>\\n               <div class=\"meta-item\">\\n                 <span class=\"meta-label\">Remote:</span>\\n                 <span class=\"meta-value\">').concat(m.location.remote?m.location.remote.charAt(0).toUpperCase()+m.location.remote.slice(1):\"No\",'</span>\\n               </div>\\n            </div>\\n          </div>\\n          \\n          <div class=\"job-body\">\\n            <h3>Description</h3>\\n            <p>').concat(m.description,\"</p>\\n            \\n            \").concat(m.requirements&&m.requirements.length>0?\"<h3>Requirements</h3><p>\".concat((m.requirements||\"\").toString().replace(/,/g,\", \"),\"</p>\"):\"\",\"\\n            \\n            \").concat(m.visaTypes&&m.visaTypes.length>0?\"<h3>Visa Types</h3>\":\"\",'\\n            <div class=\"job-tags\">\\n               ').concat(m.visaTypes?m.visaTypes.map(function(e){return'<span class=\"tag\">'.concat(e,\"</span>\")}).join(\"\"):\"\",'\\n            </div>\\n          </div>\\n          \\n          <div class=\"job-actions\">\\n            ').concat(w?\"\":k,\"\\n            \").concat(w?\"\":'<button class=\"'.concat(g,'\" id=\"saveJobBtn\" data-id=\"').concat(m._id,'\">').concat(h,\"</button>\"),'\\n            <button class=\"btn--text btn--report\" id=\"reportJobBtn\" data-id=\"').concat(m._id,'\" style=\"font-size: 1.2rem; color: #999; text-decoration: underline; margin-top: 1rem; background: none; border: none; cursor: pointer;\">Report Job</button>\\n          </div>\\n        </div>\\n      '),r.innerHTML=j,(x=document.getElementById(\"reportJobBtn\"))&&x.addEventListener(\"click\",function(){b(m._id,x)}),C=document.getElementById(\"applyProfileCvBtn\"),E=document.getElementById(\"applyUploadCvBtn\"),L=document.getElementById(\"cvUpload\"),A=document.getElementById(\"saveCvCheck\"),C&&C.addEventListener(\"click\",s(a().m(function n(){var o;return a().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,C.textContent=\"Applying...\",C.disabled=!0,n.n=1,e.default.post(\"/api/v1/jobs/\".concat(m._id,\"/apply\"),{useProfileCv:\"true\"});case 1:(0,t.showAlert)(\"success\",\"Application sent successfully!\"),C.textContent=\"Applied\",E&&(E.style.display=\"none\"),n.n=3;break;case 2:n.p=2,o=n.v,C.disabled=!1,C.textContent=\"Apply with Profile CV\",(0,t.showAlert)(\"error\",o.response&&o.response.data.message?o.response.data.message:\"Error applying\");case 3:return n.a(2)}},n,null,[[0,2]])}))),E&&L&&(E.addEventListener(\"click\",function(){L.click()}),L.addEventListener(\"change\",function(){var n=s(a().m(function n(o){var r,s,c;return a().w(function(n){for(;;)switch(n.p=n.n){case 0:if(r=o.target.files[0]){n.n=1;break}return n.a(2);case 1:return(s=new FormData).append(\"cv\",r),A&&A.checked&&s.append(\"saveCvToProfile\",\"true\"),n.p=2,E.textContent=\"Uploading...\",E.disabled=!0,n.n=3,e.default.post(\"/api/v1/jobs/\".concat(m._id,\"/apply\"),s,{headers:{\"Content-Type\":\"multipart/form-data\"}});case 3:(0,t.showAlert)(\"success\",\"Application sent successfully!\"),E.textContent=\"Applied\",A&&(A.parentElement.style.display=\"none\"),n.n=5;break;case 4:n.p=4,c=n.v,E.disabled=!1,E.textContent=l?\"Upload different CV\":\"Apply Now\",(0,t.showAlert)(\"error\",c.response&&c.response.data.message?c.response.data.message:\"Error uploading CV\");case 5:return n.a(2)}},n,null,[[2,4]])}));return function(e){return n.apply(this,arguments)}}())),(B=document.getElementById(\"closeDetailsBtn\"))&&B.addEventListener(\"click\",function(){r.classList.remove(\"details--open\"),document.body.classList.remove(\"no-scroll\")}),(_=document.getElementById(\"saveJobBtn\"))&&_.addEventListener(\"click\",function(){var n=s(a().m(function n(o){var r,s;return a().w(function(n){for(;;)switch(n.p=n.n){case 0:if(o.preventDefault(),r=_.dataset.id,s=_.classList.contains(\"btn--saved\"),n.p=1,!s){n.n=3;break}return n.n=2,e.default.delete(\"/api/v1/jobs/\".concat(r,\"/save\"));case 2:_.textContent=\"Save Job\",_.classList.remove(\"btn--saved\"),(0,t.showAlert)(\"success\",\"Job removed from saved list\"),n.n=5;break;case 3:return n.n=4,e.default.post(\"/api/v1/jobs/\".concat(r,\"/save\"));case 4:_.textContent=\"Saved\",_.classList.add(\"btn--saved\"),(0,t.showAlert)(\"success\",\"Job saved successfully\");case 5:n.n=7;break;case 6:n.p=6,n.v,(0,t.showAlert)(\"error\",\"Please login to save jobs\");case 7:return n.a(2)}},n,null,[[1,6]])}));return function(e){return n.apply(this,arguments)}}())),n.n=11;break;case 10:n.p=10,n.v,(0,t.showAlert)(\"error\",\"Error loading job details\");case 11:return n.a(2)}},n,null,[[4,6],[2,8],[0,10]])}));return function(e){return n.apply(this,arguments)}}(),exports.initJobDetail=function(){var e=document.getElementById(\"reportJobBtn\");e&&e.addEventListener(\"click\",function(t){t.preventDefault(),b(e.dataset.id,e)})},exports.searchJobs=function(){var e=s(a().m(function e(t){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,y(\"/api/v1/jobs/search\",t);case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),exports.searchSavedJobs=function(){var e=s(a().m(function e(t){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,y(\"/api/v1/jobs/saved\",t);case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();var y=function(){var n=s(a().m(function n(o,r){var s,i,l,d,p;return a().w(function(n){for(;;)switch(n.p=n.n){case 0:if(c){n.n=1;break}return n.a(2);case 1:return n.p=1,n.n=2,e.default.get(o,{params:r});case 2:if(\"success\"!==(s=n.v).data.status){n.n=4;break}if(i=s.data.data.jobs,c.innerHTML=\"\",0!==i.length){n.n=3;break}return l=o.includes(\"saved\")?\"Saved jobs will show up here.\":\"No jobs found matching your criteria.\",c.innerHTML='\\n          <div class=\"no-results-container\">\\n            <p class=\"no-results text-gradient\">'.concat(l,\"</p>\\n          </div>\\n        \"),n.a(2);case 3:i.forEach(function(e,t){var n=e.featured,a='\\n          <div class=\"job-card\" tabindex=\"0\" data-id=\"'.concat(e._id,'\" data-index=\"').concat(t+1,'\">\\n            ').concat(n?'<p class=\"featured__label\">Featured</p>':\"\",'\\n            <h3 class=\"job-card__title\">').concat(e.title,'</h3>\\n            <p class=\"job-card__company\">').concat(e.postedBy?e.postedBy.name:\"Company\",'</p>\\n            <div class=\"job-card__location\">\\n              <p>').concat(e.location.city,\"</p>\\n              <p>\").concat(e.location.postcode,\"</p>\\n              <p>Remote: \").concat(e.location.remote?e.location.remote.charAt(0).toUpperCase()+e.location.remote.slice(1):\"No\",'</p>\\n            </div>\\n            <p class=\"job-card__description\">').concat(e.description,\"</p>\\n          </div>\\n        \");c.insertAdjacentHTML(\"beforeend\",a)}),d='\\n        <div class=\"results-status\" style=\"position: sticky; bottom: 0; background: var(--bg-body, #fff); padding: 10px; border-top: 1px solid #eee; font-size: 1.1rem; font-weight: 500; color: #555; z-index: 10;\">\\n            '.concat(i.length,\" results found\\n        </div>\\n      \"),c.insertAdjacentHTML(\"beforeend\",d);case 4:n.n=6;break;case 5:n.p=5,p=n.v,(0,t.showAlert)(\"error\",p);case 6:return n.a(2)}},n,null,[[1,5]])}));return function(e,t){return n.apply(this,arguments)}}();"},"sourceMaps":null,"error":null,"hash":"8c7f836376b1610b748316875eac2d16","cacheData":{"env":{}}}