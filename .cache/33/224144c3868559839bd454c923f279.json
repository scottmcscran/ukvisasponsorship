{"id":"sfHE","dependencies":[{"name":"C:\\Users\\wrigh\\Desktop\\Projects\\ukvisasponsorship\\package.json","includedInParent":true,"mtime":1764337835993},{"name":"axios","loc":{"line":1,"column":18,"index":18},"parent":"C:\\Users\\wrigh\\Desktop\\Projects\\ukvisasponsorship\\public\\js\\admin.js","resolved":"C:\\Users\\wrigh\\Desktop\\Projects\\ukvisasponsorship\\node_modules\\axios\\index.js"},{"name":"./alerts","loc":{"line":2,"column":26,"index":54},"parent":"C:\\Users\\wrigh\\Desktop\\Projects\\ukvisasponsorship\\public\\js\\admin.js","resolved":"C:\\Users\\wrigh\\Desktop\\Projects\\ukvisasponsorship\\public\\js\\alerts.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.initAdmin=void 0;var e=n(require(\"axios\")),t=require(\"./alerts\");function n(e){return e&&e.__esModule?e:{default:e}}function o(){var e,t,n=\"function\"==typeof Symbol?Symbol:{},a=n.iterator||\"@@iterator\",s=n.toStringTag||\"@@toStringTag\";function c(n,o,a,s){var c=o&&o.prototype instanceof l?o:l,u=Object.create(c.prototype);return r(u,\"_invoke\",function(n,o,r){var a,s,c,l=0,u=r||[],d=!1,m={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,s=0,c=e,m.n=n,i}};function p(n,o){for(s=n,c=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,a=u[t],p=m.p,f=a[2];n>3?(r=f===o)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=p&&((r=n<2&&p<a[1])?(s=0,m.v=o,m.n=a[1]):p<f&&(r=n<3||a[0]>o||o>f)&&(a[4]=n,a[5]=o,m.n=f,s=0))}if(r||n>1)return i;throw d=!0,o}return function(r,u,f){if(l>1)throw TypeError(\"Generator is already running\");for(d&&1===u&&p(u,f),s=u,c=f;(t=s<2?e:c)||!d;){a||(s?s<3?(s>1&&(m.n=-1),p(s,c)):m.n=c:m.v=c);try{if(l=2,a){if(s||(r=\"next\"),t=a[r]){if(!(t=t.call(a,c)))throw TypeError(\"iterator result is not an object\");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(c=TypeError(\"The iterator does not provide a '\"+r+\"' method\"),s=1);a=e}else if((t=(d=m.n<0)?c:n.call(o,m))!==i)break}catch(t){a=e,s=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,a,s),!0),u}var i={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var m=[][a]?t(t([][a]())):(r(t={},a,function(){return this}),t),p=d.prototype=l.prototype=Object.create(m);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,r(e,s,\"GeneratorFunction\")),e.prototype=Object.create(p),e}return u.prototype=d,r(p,\"constructor\",d),r(d,\"constructor\",u),u.displayName=\"GeneratorFunction\",r(d,s,\"GeneratorFunction\"),r(p),r(p,s,\"Generator\"),r(p,a,function(){return this}),r(p,\"toString\",function(){return\"[object Generator]\"}),(o=function(){return{w:c,m:f}})()}function r(e,t,n,o){var a=Object.defineProperty;try{a({},\"\",{})}catch(e){a=0}(r=function(e,t,n,o){function s(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(s(\"next\",0),s(\"throw\",1),s(\"return\",2))})(e,t,n,o)}function a(e,t,n,o,r,a,s){try{var c=e[a](s),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(o,r)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var s=e.apply(t,n);function c(e){a(s,o,r,c,i,\"next\",e)}function i(e){a(s,o,r,c,i,\"throw\",e)}c(void 0)})}}var c=exports.initAdmin=function(){if(document.querySelector(\".dashboard-container\")){var n=document.querySelector(\".dashboard-header h2\");if(n&&n.textContent.includes(\"Admin Dashboard\")){var r=document.querySelector(\".dashboard-tabs\"),a=document.querySelectorAll(\".tab-btn\"),c=document.querySelectorAll(\".tab-content\");r&&r.addEventListener(\"click\",function(e){var t=e.target.closest(\".tab-btn\");t&&(a.forEach(function(e){return e.classList.remove(\"tab-btn--active\")}),c.forEach(function(e){return e.classList.remove(\"tab-content--active\")}),t.classList.add(\"tab-btn--active\"),document.querySelector('.tab-content[id=\"'.concat(t.dataset.tab,'\"]')).classList.add(\"tab-content--active\"))});var i=document.getElementById(\"confirmModal\"),l=document.getElementById(\"confirmBtn\"),u=document.getElementById(\"cancelBtn\"),d=document.querySelector(\".btn-close-modal\"),m=document.getElementById(\"confirmTitle\"),p=document.getElementById(\"confirmMessage\"),f=null,v=null,y=function(e,t,n,o){m.textContent=e,p.textContent=t,f=n,v=o,i.classList.remove(\"hidden\")},b=function(){i.classList.add(\"hidden\"),f=null,v=null};i&&(d.addEventListener(\"click\",b),u.addEventListener(\"click\",b),i.addEventListener(\"click\",function(e){e.target===i&&b()}),l.addEventListener(\"click\",s(o().m(function n(){var r,a,s,c;return o().w(function(n){for(;;)switch(n.p=n.n){case 0:if(f&&v){n.n=1;break}return n.a(2);case 1:if(r=l.textContent,l.textContent=\"Processing...\",n.p=2,\"approveEmployer\"!==f){n.n=4;break}return n.n=3,e.default.post(\"/api/v1/admin/\".concat(v,\"/employer-verification\"));case 3:(0,t.showAlert)(\"success\",\"Employer approved successfully!\"),n.n=12;break;case 4:if(\"rejectEmployer\"!==f){n.n=6;break}return n.n=5,e.default.delete(\"/api/v1/admin/\".concat(v,\"/employer-verification\"));case 5:(0,t.showAlert)(\"success\",\"Employer rejected successfully!\"),n.n=12;break;case 6:if(\"deleteJob\"!==f){n.n=8;break}return n.n=7,e.default.delete(\"/api/v1/admin/jobs/\".concat(v));case 7:(0,t.showAlert)(\"success\",\"Job deleted successfully!\"),n.n=12;break;case 8:if(\"dismissReport\"!==f){n.n=10;break}return n.n=9,e.default.patch(\"/api/v1/admin/jobs/\".concat(v,\"/dismiss\"));case 9:(0,t.showAlert)(\"success\",\"Report dismissed successfully!\"),n.n=12;break;case 10:if(\"deleteBug\"!==f){n.n=12;break}return n.n=11,e.default.delete(\"/api/v1/bug-reports/\".concat(v));case 11:(0,t.showAlert)(\"success\",\"Bug report deleted successfully!\");case 12:a=\"approveEmployer\"===f||\"rejectEmployer\"===f?'[data-user-id=\"'.concat(v,'\"]'):\"deleteBug\"===f?'[data-bug-id=\"'.concat(v,'\"]'):'[data-job-id=\"'.concat(v,'\"]'),document.querySelectorAll(\".job-item \".concat(a)).forEach(function(e){var t=e.closest(\".job-item\");t&&(t.style.transition=\"all 0.5s ease\",t.style.opacity=\"0\",t.style.transform=\"translateX(20px)\",setTimeout(function(){return t.remove()},500))}),b(),n.n=14;break;case 13:n.p=13,c=n.v,console.error(c),(0,t.showAlert)(\"error\",(null===(s=c.response)||void 0===s||null===(s=s.data)||void 0===s?void 0:s.message)||\"Something went wrong!\");case 14:return n.p=14,l.textContent=r,n.f(14);case 15:return n.a(2)}},n,null,[[2,13,14,15]])}))));var h=document.getElementById(\"viewJobModal\"),g=document.querySelectorAll(\".close-view-modal\"),E=function(){var n=s(o().m(function n(r){var a,s,c,i,l;return o().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e.default.get(\"/api/v1/jobs/\".concat(r));case 1:a=n.v,s=a.data.data.job,document.getElementById(\"viewJobTitle\").textContent=s.title,document.getElementById(\"viewJobCompany\").textContent=s.companyName||\"N/A\",document.getElementById(\"viewJobLocation\").textContent=\"\".concat(s.location.city,\", \").concat(s.location.postcode),document.getElementById(\"viewJobSalary\").textContent=\"£\".concat(s.salaryRange.min,\" - £\").concat(s.salaryRange.max||\"N/A\"),document.getElementById(\"viewJobDescription\").innerHTML=s.description,c=document.getElementById(\"modalDismissBtn\"),i=document.getElementById(\"modalDeleteBtn\"),c&&(c.dataset.jobId=s._id),i&&(i.dataset.jobId=s._id),h.classList.remove(\"hidden\"),n.n=3;break;case 2:n.p=2,l=n.v,console.error(l),(0,t.showAlert)(\"error\",\"Could not fetch job details\");case 3:return n.a(2)}},n,null,[[0,2]])}));return function(e){return n.apply(this,arguments)}}(),w=function(){h.classList.add(\"hidden\")};h&&(g.forEach(function(e){return e.addEventListener(\"click\",w)}),h.addEventListener(\"click\",function(e){e.target===h&&w()})),document.body.addEventListener(\"click\",function(e){var t=e.target.closest(\".btn--approve-employer\"),n=e.target.closest(\".btn--reject-employer\"),o=e.target.closest(\".btn--delete-job\"),r=e.target.closest(\".btn--dismiss-report\"),a=e.target.closest(\".btn--view-job\"),s=e.target.closest(\".btn--fix-bug\");if(a&&E(a.dataset.jobId),s){var c=s.dataset.bugId;y(\"Delete Bug Report\",\"Are you sure you want to mark this bug as fixed and delete it?\",\"deleteBug\",c)}if(t){var i=t.dataset,l=i.userId,u=i.companyName;y(\"Approve Employer\",\"Are you sure you want to approve \".concat(u,\"? They will be able to post jobs immediately.\"),\"approveEmployer\",l)}if(n){var d=n.dataset,m=d.userId,p=d.companyName;y(\"Reject Employer\",\"Are you sure you want to reject \".concat(p,\"? This cannot be undone easily.\"),\"rejectEmployer\",m)}if(o){var f=o.dataset.jobId;h&&!h.classList.contains(\"hidden\")&&w(),y(\"Delete Job\",\"Are you sure you want to delete this job? This action cannot be undone.\",\"deleteJob\",f)}if(r){var v=r.dataset.jobId;h&&!h.classList.contains(\"hidden\")&&w(),y(\"Dismiss Report\",\"Are you sure you want to dismiss the reports on this job? It will be set to active again.\",\"dismissReport\",v)}});var B=document.querySelector(\".form--export-data\"),I=document.getElementById(\"exportOutput\"),x=document.querySelector(\".export-result\"),A=document.getElementById(\"btnDownloadJson\"),C=null;B&&(B.addEventListener(\"submit\",function(){var n=s(o().m(function n(r){var a,s,c,i,l;return o().w(function(n){for(;;)switch(n.p=n.n){case 0:return r.preventDefault(),a=document.getElementById(\"exportEmail\").value,(s=document.getElementById(\"btnExportData\")).textContent=\"Exporting...\",n.p=1,n.n=2,e.default.post(\"/api/v1/admin/export-user-data\",{email:a});case 2:c=n.v,C=c.data.data,I.textContent=JSON.stringify(C,null,2),x.classList.remove(\"hidden\"),(0,t.showAlert)(\"success\",\"Data retrieved successfully\"),n.n=4;break;case 3:n.p=3,l=n.v,console.error(l),(0,t.showAlert)(\"error\",(null===(i=l.response)||void 0===i||null===(i=i.data)||void 0===i?void 0:i.message)||\"Error retrieving data\"),x.classList.add(\"hidden\");case 4:return n.p=4,s.textContent=\"Export Data\",n.f(4);case 5:return n.a(2)}},n,null,[[1,3,4,5]])}));return function(e){return n.apply(this,arguments)}}()),A&&A.addEventListener(\"click\",function(){if(C){var e=\"data:text/json;charset=utf-8,\"+encodeURIComponent(JSON.stringify(C,null,2)),t=document.createElement(\"a\");t.setAttribute(\"href\",e),t.setAttribute(\"download\",\"user_data_\".concat(C.profile.email,\".json\")),document.body.appendChild(t),t.click(),t.remove()}}));var j=document.getElementById(\"createShadowBtn\"),k=document.getElementById(\"shadowJobSection\"),L=document.getElementById(\"shadowCompanyNameDisplay\"),S=document.getElementById(\"shadowUserId\"),J=document.getElementById(\"postShadowJobBtn\"),T=document.getElementById(\"sendClaimEmailBtn\"),D=document.getElementById(\"shadowJobsListUl\");j&&j.addEventListener(\"click\",function(){var n=s(o().m(function n(r){var a,s,c,i,l,u,d;return o().w(function(n){for(;;)switch(n.p=n.n){case 0:if(r.preventDefault(),a=document.getElementById(\"shadowCompanyName\").value,s=document.getElementById(\"shadowEmail\").value,c=document.getElementById(\"shadowIndustry\").value,a&&s){n.n=1;break}return n.a(2,(0,t.showAlert)(\"error\",\"Please provide company name and email\"));case 1:return j.textContent=\"Creating...\",n.p=2,n.n=3,e.default.post(\"/api/v1/admin/shadow-employer\",{companyName:a,email:s,industry:c});case 3:\"success\"===(i=n.v).data.status&&((0,t.showAlert)(\"success\",\"Shadow account created!\"),l=i.data.data.user,k.classList.remove(\"hidden\"),L.textContent=l.companyProfile.companyName,S.value=l._id,document.getElementById(\"shadowCompanyName\").disabled=!0,document.getElementById(\"shadowEmail\").disabled=!0,document.getElementById(\"shadowIndustry\").disabled=!0,j.disabled=!0,j.textContent=\"Created\"),n.n=5;break;case 4:n.p=4,d=n.v,(0,t.showAlert)(\"error\",(null===(u=d.response)||void 0===u||null===(u=u.data)||void 0===u?void 0:u.message)||\"Error creating account\"),j.textContent=\"Create Account\";case 5:return n.a(2)}},n,null,[[2,4]])}));return function(e){return n.apply(this,arguments)}}()),J&&J.addEventListener(\"click\",function(){var n=s(o().m(function n(r){var a,s,c,i,l,u,d,m,p,f,v,y,b,h;return o().w(function(n){for(;;)switch(n.p=n.n){case 0:if(r.preventDefault(),a=S.value){n.n=1;break}return n.a(2,(0,t.showAlert)(\"error\",\"No user selected\"));case 1:if(s=document.getElementById(\"shadowJobTitle\").value,c=document.getElementById(\"shadowJobDescription\").value,i=document.getElementById(\"shadowJobLocation\").value,l=document.getElementById(\"shadowJobPostcode\").value,u=document.getElementById(\"shadowJobSalaryMin\").value,d=document.getElementById(\"shadowJobSalaryMax\").value,m=document.getElementById(\"shadowJobType\").value,p=document.getElementById(\"shadowJobExperience\").value,f=document.getElementById(\"shadowJobLink\").value,v=document.getElementById(\"shadowJobVisa\"),y=Array.from(v.selectedOptions).map(function(e){return e.value}),s&&c&&i&&l&&u&&0!==y.length){n.n=2;break}return n.a(2,(0,t.showAlert)(\"error\",\"Please fill in all required fields\"));case 2:return J.textContent=\"Posting...\",n.p=3,n.n=4,e.default.post(\"/api/v1/jobs\",{title:s,description:c,location:{city:i,postcode:l},salaryRange:{min:u,max:d||u},jobType:m,experienceLevel:p,visaTypes:y,applicationUrl:f,postedBy:a});case 4:\"success\"===n.v.data.status&&((0,t.showAlert)(\"success\",\"Job posted successfully!\"),J.textContent=\"Post Job\",(b=document.createElement(\"li\")).textContent=\"\".concat(s,\" - \").concat(i,\" (£\").concat(u,\")\"),b.style.marginBottom=\"5px\",D.appendChild(b),document.querySelector(\".form--shadow-job\").reset(),S.value=a),n.n=6;break;case 5:n.p=5,h=n.v,(0,t.showAlert)(\"error\",h.response.data.message),J.textContent=\"Post Job\";case 6:return n.a(2)}},n,null,[[3,5]])}));return function(e){return n.apply(this,arguments)}}()),T&&T.addEventListener(\"click\",function(){var n=s(o().m(function n(r){var a,s;return o().w(function(n){for(;;)switch(n.p=n.n){case 0:if(r.preventDefault(),a=S.value){n.n=1;break}return n.a(2,(0,t.showAlert)(\"error\",\"No user selected\"));case 1:if(confirm(\"Are you sure you want to send the claim email? Make sure you have added all jobs first.\")){n.n=2;break}return n.a(2);case 2:return T.textContent=\"Sending...\",n.p=3,n.n=4,e.default.post(\"/api/v1/admin/users/\".concat(a,\"/send-claim-email\"));case 4:\"success\"===n.v.data.status&&((0,t.showAlert)(\"success\",\"Claim email sent!\"),T.textContent=\"Email Sent\",T.disabled=!0,setTimeout(function(){location.reload()},2e3)),n.n=6;break;case 5:n.p=5,s=n.v,(0,t.showAlert)(\"error\",s.response.data.message),T.textContent=\"Send Claim Email\";case 6:return n.a(2)}},n,null,[[3,5]])}));return function(e){return n.apply(this,arguments)}}());var P=document.querySelector(\".form--create-blog\");P&&P.addEventListener(\"submit\",function(){var n=s(o().m(function n(r){var a,s,c,i,l,u;return o().w(function(n){for(;;)switch(n.p=n.n){case 0:return r.preventDefault(),(a=document.getElementById(\"createBlogBtn\")).textContent=\"Publishing...\",s=document.getElementById(\"blogTitle\").value,c=document.getElementById(\"blogSummary\").value,i=document.getElementById(\"blogContent\").value,n.p=1,n.n=2,e.default.post(\"/api/v1/articles\",{title:s,summary:c,content:i});case 2:\"success\"===n.v.data.status&&((0,t.showAlert)(\"success\",\"Article published successfully!\"),a.textContent=\"Publish Article\",P.reset()),n.n=4;break;case 3:n.p=3,u=n.v,(0,t.showAlert)(\"error\",(null===(l=u.response)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.message)||\"Error publishing article\"),a.textContent=\"Publish Article\";case 4:return n.a(2)}},n,null,[[1,3]])}));return function(e){return n.apply(this,arguments)}}())}}};"},"sourceMaps":null,"error":null,"hash":"ab1543e3f278b7725451e1a1b4f205ca","cacheData":{"env":{}}}